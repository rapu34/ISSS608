{
  "hash": "1d0f1d37264620cdaaf99aefea287a8f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home_Ex1_version2\"\nauthor: \"Jeounghyun Kim\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n# **Take-home Exercise 1**\n\n## **1 Overview**\n\n### **1.1 Introduction**\n\nAccording to the World Health Organization (WHO), cardiovascular diseases (CVDs) are the leading cause of death globally, accounting for approximately 17.9 million deaths per year. Among CVDs, heart attacks are one of the most critical and life-threatening conditions, making early prevention and risk factor analysis essential.\n\nThis dataset provides an in-depth analysis of heart attack incidents in Japan, with a focus on the differences between youth and adult populations. It includes various medical indicators (cholesterol levels, blood pressure, maximum heart rate), lifestyle factors (exercise, diet), and demographic information, offering valuable insights into age-specific cardiovascular risks. By analyzing this dataset, researchers, healthcare professionals, and policymakers can gain a deeper understanding of these risks and develop more effective prevention strategies.\n\nThis dataset serves as a valuable resource for comparison with global cardiovascular research efforts, such as WHO's 'Global Hearts' initiative and the CDC's 'Million Hearts' program. Additionally, it supports statistical modeling, trend visualization, and predictive analytics, contributing to the development of data-driven public health policies and early intervention programs aimed at reducing the prevalence of cardiovascular diseases.\n\n## \n\n## **1.2 The Data**\n\nThe data for this analysis comes from the **Heart Attack in Japan: Youth vs. Adult** dataset, retrieved from the [Kaggle database](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult/data). The dataset provides detailed information on heart attack incidents among youth and adults, focusing on medical indicators, lifestyle factors, and demographic characteristics.\n\n### **Dataset Components**\n\nThe dataset includes various features, such as:\n\n-   **Demographic Information:** Age, gender, and residential region (Urban/Rural).\n\n-   **Medical History:** Presence of pre-existing conditions such as **diabetes** and **hypertension**.\n\n-   **Lifestyle Factors:**\n\n    -   **Smoking History** and **Alcohol Consumption** levels.\n\n    -   **Physical Activity** categorized as High, Moderate, or Low.\n\n    -   **Diet Quality** classified as Good, Average, or Poor.\n\n-   **Medical Indicators:**\n\n    -   **Cholesterol Levels** (numerical values).\n\n    -   **Resting Blood Pressure** *(if available in the full dataset)*.\n\n-   **Additional Data Fields:** The dataset contains extra computed columns that may require further preprocessing for analysis.\n\nThis dataset serves as a valuable resource for data analysts, healthcare professionals, and policymakers aiming to understand and mitigate cardiovascular risks in Japan. Proper data preprocessing and ethical considerations are recommended before conducting any analysis.\n\n## **Getting started**\n\n### **Load Packages**\n\nWe load the following R packages using the **`pacman::p_load()`** function to streamline the workflow:\n\n-   **tidyverse**: A core collection of R packages designed for data science and data manipulation.\n\n-   **ggiraph**: Provides interactive ggplot2 visualizations.\n\n-   **plotly**: Enables interactive plots for data exploration.\n\n-   **patchwork**: Facilitates combining multiple `ggplot2` visualizations into a cohesive layout.\n\n-   **DT**: Provides an interactive table interface for data visualization.\n\n-   **corrplot**: Generates visualizations for correlation matrices.\n\n-   **reshape2**: Helps with data reshaping for efficient analysis.\n\n-   **GGally**: Extends `ggplot2` for correlation and pairwise visualizations.\n\n-   **zoo**: Provides functions for time series data manipulation and rolling window calculations.\n\n-   **ggcorrplot**: Specialized in correlation matrix visualization using `ggplot2`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggiraph, plotly, patchwork, DT, tidyverse, \n               corrplot, reshape2, GGally, zoo, ggcorrplot,ggstatsplot)\n```\n:::\n\n\n\nImport data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_csv(\"japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\n### **Data pre-processing**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 32\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Gender                  <chr> \"Male\", \"Male\", \"Male\", \"Female\", \"Female\", \"F…\n$ Region                  <chr> \"Urban\", \"Urban\", \"Rural\", \"Urban\", \"Rural\", \"…\n$ Smoking_History         <chr> \"Yes\", \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"Y…\n$ Diabetes_History        <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Hypertension_History    <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <chr> \"Moderate\", \"Low\", \"Low\", \"Moderate\", \"High\", …\n$ Diet_Quality            <chr> \"Poor\", \"Good\", \"Average\", \"Good\", \"Good\", \"Go…\n$ Alcohol_Consumption     <chr> \"Low\", \"Low\", \"Moderate\", \"High\", \"High\", \"Hig…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <chr> \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No…\n$ Heart_Attack_Occurrence <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\"…\n$ Extra_Column_1          <dbl> 0.40498852, 0.03627815, 0.85297888, 0.39085280…\n$ Extra_Column_2          <dbl> 0.43330004, 0.51256694, 0.21959083, 0.29684675…\n$ Extra_Column_3          <dbl> 0.62871236, 0.66839275, 0.61343656, 0.15572404…\n$ Extra_Column_4          <dbl> 0.70160955, 0.11552874, 0.50800995, 0.87025144…\n$ Extra_Column_5          <dbl> 0.49814235, 0.42381938, 0.90066981, 0.39035591…\n$ Extra_Column_6          <dbl> 0.007901312, 0.083932768, 0.227205241, 0.40318…\n$ Extra_Column_7          <dbl> 0.79458257, 0.68895108, 0.49634358, 0.74140891…\n$ Extra_Column_8          <dbl> 0.29077922, 0.83016364, 0.75210679, 0.22396813…\n$ Extra_Column_9          <dbl> 0.49719307, 0.63449028, 0.18150125, 0.32931387…\n$ Extra_Column_10         <dbl> 0.52199452, 0.30204337, 0.62918031, 0.14319054…\n$ Extra_Column_11         <dbl> 0.79965663, 0.04368285, 0.01827617, 0.90778075…\n$ Extra_Column_12         <dbl> 0.72239788, 0.45166789, 0.06322702, 0.54232201…\n$ Extra_Column_13         <dbl> 0.1487387, 0.8786714, 0.1465122, 0.9224606, 0.…\n$ Extra_Column_14         <dbl> 0.8340099, 0.5356022, 0.9972962, 0.6262165, 0.…\n$ Extra_Column_15         <dbl> 0.061632229, 0.617825340, 0.974455410, 0.22860…\n```\n\n\n:::\n:::\n\n\n\n**Check missing values**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Age                  Gender                  Region \n                      0                       0                       0 \n        Smoking_History        Diabetes_History    Hypertension_History \n                      0                       0                       0 \n      Cholesterol_Level       Physical_Activity            Diet_Quality \n                      0                       0                       0 \n    Alcohol_Consumption           Stress_Levels                     BMI \n                      0                       0                       0 \n             Heart_Rate             Systolic_BP            Diastolic_BP \n                      0                       0                       0 \n         Family_History Heart_Attack_Occurrence          Extra_Column_1 \n                      0                       0                       0 \n         Extra_Column_2          Extra_Column_3          Extra_Column_4 \n                      0                       0                       0 \n         Extra_Column_5          Extra_Column_6          Extra_Column_7 \n                      0                       0                       0 \n         Extra_Column_8          Extra_Column_9         Extra_Column_10 \n                      0                       0                       0 \n        Extra_Column_11         Extra_Column_12         Extra_Column_13 \n                      0                       0                       0 \n        Extra_Column_14         Extra_Column_15 \n                      0                       0 \n```\n\n\n:::\n:::\n\n\n\n**Data Cleaning and Encoding of Categorical Variables**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 범주형 변수 변환 (Yes/No → 0/1, Urban/Rural → 1/0, 순서형 변수 변환)\ndf <- df %>%\n  mutate(\n    smoking_history = ifelse(Smoking_History == \"Yes\", 1, 0),\n    diabetes_history = ifelse(Diabetes_History == \"Yes\", 1, 0),\n    hypertension_history = ifelse(Hypertension_History == \"Yes\", 1, 0),\n    gender = ifelse(Gender == \"Male\", 1, 0),\n    heart_attack_occurrence = ifelse(Heart_Attack_Occurrence == \"Yes\", 1, 0),\n    region = ifelse(Region == \"Urban\", 1, 0),\n    family_history = ifelse(Family_History == \"Yes\", 1, 0),  # 이진 변수 변환\n    \n    # 순서형 변수 변환 (Low → 0, Moderate → 1, High → 2)\n    physical_activity = case_when(\n      Physical_Activity == \"Low\" ~ 0,\n      Physical_Activity == \"Moderate\" ~ 1,\n      Physical_Activity == \"High\" ~ 2\n    ),\n    \n    diet_quality = case_when(\n      Diet_Quality == \"Poor\" ~ 0,\n      Diet_Quality == \"Average\" ~ 1,\n      Diet_Quality == \"Good\" ~ 2\n    ),\n    \n    alcohol_consumption = case_when(\n      Alcohol_Consumption == \"None\" ~ 0,  # 아예 안 마시는 경우\n      Alcohol_Consumption == \"Low\" ~ 1,   \n      Alcohol_Consumption == \"Moderate\" ~ 2,\n      Alcohol_Consumption == \"High\" ~ 3,\n    )\n  ) %>%\n  select(-Smoking_History, -Diabetes_History, -Hypertension_History, \n         -Gender, -Heart_Attack_Occurrence, -Region, -Family_History,\n         -Physical_Activity, -Diet_Quality, -Alcohol_Consumption,\n         -starts_with(\"Extra_Column_\")) # Extra Column 전부 삭제\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nls(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Age\"                     \"alcohol_consumption\"    \n [3] \"BMI\"                     \"Cholesterol_Level\"      \n [5] \"diabetes_history\"        \"Diastolic_BP\"           \n [7] \"diet_quality\"            \"family_history\"         \n [9] \"gender\"                  \"heart_attack_occurrence\"\n[11] \"Heart_Rate\"              \"hypertension_history\"   \n[13] \"physical_activity\"       \"region\"                 \n[15] \"smoking_history\"         \"Stress_Levels\"          \n[17] \"Systolic_BP\"            \n```\n\n\n:::\n:::\n\n\n\n## **4. Exploratory Data Analysis**\n\n4.1 **Heart Attack Occurrence Rate by Age (5-Year Rolling Average)**\n\n#### **Graph Description**\n\nThe graph visualizes the heart attack occurrence rate across different ages, with a 5-year rolling average applied to smooth fluctuations. The red line represents the raw occurrence rate, while the blue line highlights the trend. The rate generally increases with age, but interestingly, there are notable variations across different age groups.\n\n::: panel-tabset\n## The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex1_version2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## The code chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#1\n# 필요한 패키지 로드\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(zoo)\n\n# 데이터 확인 및 변환\nage_heart_attack_rate <- df %>%\n  group_by(Age) %>%\n  summarize(heart_attack_rate = mean(heart_attack_occurrence, na.rm = TRUE)) %>%\n  ungroup() %>%\n  mutate(Age = as.numeric(Age))  # Age를 숫자로 변환 (필수)\n\n# 5년 이동평균 추가 (NA 값 방지)\nage_heart_attack_rate <- age_heart_attack_rate %>%\n  arrange(Age) %>%\n  mutate(rolling_avg = rollmean(heart_attack_rate, k = 5, fill = mean(heart_attack_rate, na.rm = TRUE), align = \"right\", na.rm = TRUE))\n\n# 시각화 (NA 값 제외)\nggplot(na.omit(age_heart_attack_rate), aes(x = Age)) +\n  geom_line(aes(y = heart_attack_rate), color = \"red\", size = 1, alpha = 0.5) +  # 원본 데이터 (빨간색)\n  geom_line(aes(y = rolling_avg), color = \"blue\", size = 1.2) +  # 이동평균 적용 (파란색)\n  geom_point(aes(y = rolling_avg), color = \"blue\", size = 2) +  # 이동평균 점 추가\n  labs(title = \"Heart Attack Occurrence Rate by Age (5-Year Rolling Avg)\",\n       x = \"Age\",\n       y = \"Heart Attack Occurrence (%)\") +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 14),\n    axis.text = element_text(size = 12),\n    axis.title = element_text(size = 12, face = \"bold\"),\n    panel.grid.major = element_line(color = \"gray\", linetype = \"dashed\")\n  )\n```\n:::\n\n\n:::\n\n#### **Observation**\n\nAn unexpectedly high occurrence is observed in the 30s and 40s, suggesting that younger adults may also be at risk. The rate temporarily declines in the late 50s before rising again sharply from the late 60s onward. The high occurrence in younger individuals could be attributed to lifestyle factors like stress, smoking, or underlying health conditions, while the decline in the late 50s might indicate medical intervention or lifestyle modifications. The increase in older adults aligns with conventional risk factors such as hypertension, diabetes, and cardiovascular aging.\n\n4.2 **Heart Attack and Risk Factors by Age Group (10-Year Intervals)**\n\n#### **Graph Description**\n\nThis graph illustrates the heart attack rate along with key risk factors—**smoking, hypertension, and diabetes**—across different age groups in **10-year intervals**. Each colored line represents a different variable, highlighting how these factors change with age.\n\n::: panel-tabset\n## The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex1_version2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n## The code chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#2번\n# 연령대별 심장마비 발생률 + 다른 변수 추가 분석\ndf %>%\n  mutate(Age_Group = cut(Age, \n                         breaks = c(0, 20, 30, 40, 50, 60, 70, 80, Inf),  \n                         include.lowest = TRUE, \n                         right = FALSE, \n                         labels = c(\"<20\", \"20s\", \"30s\", \"40s\", \"50s\", \"60s\", \"70s\", \"80+\"))) %>%\n  mutate(Age_Group = factor(Age_Group, levels = c(\"<20\", \"20s\", \"30s\", \"40s\", \"50s\", \"60s\", \"70s\", \"80+\"))) %>%\n  group_by(Age_Group) %>%\n  summarise(\n    heart_attack_rate = mean(heart_attack_occurrence, na.rm = TRUE) * 100,\n    smoking_rate = mean(smoking_history, na.rm = TRUE) * 100,  \n    hypertension_rate = mean(hypertension_history, na.rm = TRUE) * 100,  \n    diabetes_rate = mean(diabetes_history, na.rm = TRUE) * 100  \n  ) %>%\n  pivot_longer(cols = c(heart_attack_rate, smoking_rate, hypertension_rate, diabetes_rate),\n               names_to = \"variable\", values_to = \"rate\") %>%\n  ggplot(aes(x = Age_Group, y = rate, color = variable, group = variable)) +\n  geom_line(size = 1.2) +  \n  geom_point(size = 3) +  \n  labs(title = \"Heart Attack and Risk Factors by Age Group (10-year intervals)\",\n       x = \"Age Group\",\n       y = \"Rate (%)\") +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 14),\n    axis.text.x = element_text(size = 12), \n    axis.title = element_text(size = 12, face = \"bold\"),\n    panel.grid.major = element_line(color = \"gray\", linetype = \"dashed\")\n  )\n```\n:::\n\n\n:::\n\n**Observation**\n\n-   Hypertension and diabetes rates increase steadily until the 50s, followed by a slight decline after 60. This may reflect cumulative health risks from earlier life stages, but also possible medical interventions. Smoking rates peak in the 20s and 30s, then decline sharply, especially after the 60s, likely due to health concerns or cessation efforts.\n\n-   The 30s–50s group exhibits a combination of high smoking rates and increasing hypertension/diabetes, making it the most vulnerable period for heart attacks. Conversely, while smoking rates drop in older adults, pre-existing chronic conditions may continue to drive heart attack risks beyond the 60s.\n\n## **4.3 BMI Distribution by Age Group (30-40s vs. 60+)**\n\n#### **Graph Description**\n\nThis violin plot with a boxplot overlay compares the BMI distributions of individuals aged 30-40s and 60+. It provides a visual representation of the median values, spread, and density for each group.\n\n::: panel-tabset\n## The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex1_version2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## The code chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  filter(Age >= 30 & Age <= 40 | Age >= 60) %>%\n  mutate(\n    age_group = case_when(\n      Age >= 30 & Age <= 40 ~ \"30-40s\",\n      Age >= 60 ~ \"60+\"\n    ),\n    heart_attack_label = ifelse(heart_attack_occurrence == 1, \"Yes\", \"No\")\n  ) %>%\n  ggbetweenstats(\n    x = age_group, \n    y = BMI, \n    grouping.var = heart_attack_label,  \n    type = \"np\",                       # Mann-Whitney U test\n    pairwise.comparisons = TRUE,       \n    messages = FALSE\n  )\n```\n:::\n\n\n:::\n\n#### **Observation**\n\n-   The median BMI is 24.90 for the 30-40s and 24.97 for the 60+ group, showing no significant difference. A Mann-Whitney U test confirms this (W = 2.70×10⁷, p = 0.99), indicating that the BMI distribution does not differ statisticallybetween the two groups. The rank biserial correlation is nearly zero (-1.07e-04), and the confidence interval \\[-0.02, 0.02\\]suggests any difference is negligible.\n\n<!-- -->\n\n-   Since BMI is not a key differentiating factor for heart attack risk between these age groups, further analysis should focus on other potential contributors, such as physical activity, cholesterol levels, or stress levels.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#나중에 삭제\nheart_attack_by_alcohol <- df %>%\n  group_by(alcohol_consumption) %>%\n  summarize(heart_attack_rate = mean(heart_attack_occurrence, na.rm = TRUE)) %>%\n  ungroup()\n```\n:::\n\n\n\n## 4.4 Heart Attack Rate by Alcohol Consumption Level\n\n#### **Graph Description**\n\nThis bar chart illustrates the heart attack rates across different levels of alcohol consumption: None, Low, Moderate, and High. The data suggests a non-linear trend, with moderate drinkers showing the lowest heart attack rate, while both non-drinkers and heavy drinkers exhibit slightly higher rates.\n\n::: panel-tabset\n## The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex1_version2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## The code chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# 1️⃣ 데이터셋 생성 (항상 먼저 실행)\nheart_attack_by_alcohol <- df %>%\n  group_by(alcohol_consumption) %>%\n  summarize(heart_attack_rate = mean(heart_attack_occurrence, na.rm = TRUE)) %>%\n  ungroup()\n\n# 2️⃣ Alcohol Consumption 레벨을 변환\nheart_attack_by_alcohol <- heart_attack_by_alcohol %>%\n  mutate(\n    alcohol_label = factor(alcohol_consumption, \n                           levels = c(0, 1, 2, 3), \n                           labels = c(\"None\", \"Low\", \"Moderate\", \"High\"))\n  )\n\n# 3️⃣ ggplot()을 이용한 시각화\nggplot(heart_attack_by_alcohol, aes(x = alcohol_label, y = heart_attack_rate, fill = alcohol_label)) +\n  geom_bar(stat = \"identity\", width = 0.6, color = \"black\", size = 0.5) + # 막대 테두리 추가\n  scale_fill_manual(values = c(\"None\" = \"#A93226\", \"Low\" = \"#E67E22\", \"Moderate\" = \"#2ECC71\", \"High\" = \"#3498DB\")) + # 색상 강조\n  labs(\n    title = \"Heart Attack Rate by Alcohol Consumption Level\",\n    x = \"Alcohol Consumption Level\",\n    y = \"Heart Attack Rate (%)\",\n    fill = \"Alcohol Level\"\n  ) +\n  theme_minimal(base_size = 14) + \n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 18), \n    axis.title.x = element_text(size = 14, face = \"bold\"), \n    axis.title.y = element_text(size = 14, face = \"bold\"),\n    axis.text = element_text(size = 12), \n    legend.title = element_text(size = 14, face = \"bold\"), \n    legend.text = element_text(size = 12), \n    panel.grid.major = element_line(color = \"gray90\"), \n    panel.grid.minor = element_blank()\n  )\n```\n:::\n\n\n:::\n\n#### **Observation**\n\n-   The findings suggest that moderate alcohol consumption may be linked to a lower risk of heart attack, potentially due to improved circulation or reduced stress. However, this does not imply that drinking is beneficial. Other contributing factors, such as lifestyle, diet, and pre-existing health conditions, could influence these results.\n\n<!-- -->\n\n-   Further investigation is required to determine whether alcohol consumption has a direct causal effect on heart attack risk or if other confounding factors play a more significant role.\n\n## 4.5 Standardized Health Factors by Heart Attack Occurrence (by Age Group)\n\n#### **Graph Description**\n\nThis bar chart displays the standardized Z-scores of key health factors for individuals with and without heart attacks, categorized into two age groups: 30-40s and 60+. Red bars represent those who have experienced a heart attack, while blue bars represent those who have not.\n\n::: panel-tabset\n## The Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex1_version2_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n## The code chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_scaled <- df %>%\n  mutate(age_group = ifelse(Age >= 60, \"60+\", \"30-40s\")) %>%\n  group_by(age_group) %>%\n  mutate(\n    diet_quality_scaled = scale(diet_quality),\n    physical_activity_scaled = scale(physical_activity),\n    BMI_scaled = scale(BMI),\n    stress_scaled = scale(Stress_Levels),\n    cholesterol_scaled = scale(Cholesterol_Level),\n    systolic_BP_scaled = scale(Systolic_BP),\n    diastolic_BP_scaled = scale(Diastolic_BP)\n  ) %>%\n  ungroup()\n\nhealth_factors_by_age <- df_scaled %>%\n  group_by(age_group, heart_attack_occurrence) %>%\n  summarise(\n    diet_quality_avg = mean(diet_quality_scaled),\n    physical_activity_avg = mean(physical_activity_scaled),\n    BMI_avg = mean(BMI_scaled),\n    stress_avg = mean(stress_scaled),\n    cholesterol_avg = mean(cholesterol_scaled),\n    systolic_BP_avg = mean(systolic_BP_scaled),\n    diastolic_BP_avg = mean(diastolic_BP_scaled)\n  ) %>%\n  pivot_longer(cols = -c(age_group, heart_attack_occurrence), \n               names_to = \"variable\", values_to = \"value\")\n\nggplot(health_factors_by_age, aes(x = variable, y = value, fill = as.factor(heart_attack_occurrence))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~age_group) +  \n  labs(title = \"Standardized Health Factors by Heart Attack Occurrence (by Age Group)\",\n       x = \"Health Factor\",\n       y = \"Standardized Average Value (Z-score)\",\n       fill = \"Heart Attack (0: No, 1: Yes)\") +\n  scale_fill_manual(values = c(\"0\" = \"#3498DB\", \"1\" = \"#E74C3C\")) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5, face = \"bold\", size = 14),\n    axis.text.x = element_text(size = 12, angle = 45, hjust = 1),  \n    axis.title.x = element_text(face = \"bold\"),\n    legend.text = element_text(size = 10),\n    legend.title = element_text(face = \"bold\"),\n    strip.text = element_text(size = 12, face = \"bold\")  \n  )\n```\n:::\n\n\n:::\n\n#### **Observation**\n\n-   30-40s: Higher stress levels and lower physical activity are strongly linked to heart attacks, while higher cholesterol and poor diet quality are also notable risk factors, suggesting lifestyle-related contributors.\n\n<!-- -->\n\n-   60+: Significantly higher systolic blood pressure (BP) is observed in heart attack patients. Unlike younger groups, chronic conditions such as hypertension and cholesterol levels appear to be dominant risk factors.\n\n<!-- -->\n\n-   Conclusion: For younger individuals (30-40s), lifestyle factors such as stress and physical activity matter more. In contrast, for older individuals (60+), managing chronic conditions like high blood pressure is crucial in reducing heart attack risks.\n\n## **5 Conclusion**\n\nIn conclusion, the **ggplot2** package has proven to be a powerful tool for exploratory data analysis through visualization. This study analyzed various health factors influencing heart attack occurrences, revealing key insights across different age groups. Younger individuals (30-40s) showed **higher stress levels and lower physical activity** as major risk factors, whereas older individuals (60+) exhibited **higher systolic blood pressure and cholesterol levels**, emphasizing the role of chronic conditions.\n\n### 5.1 Future Recommendations:\n\n-   Further research should incorporate longitudinal studies to understand the causal relationship between stress, physical activity, and heart disease in younger populations.\n\n-   Policy interventions targeting stress reduction and physical activity promotion among working-age adults should be considered.\n\n-   Healthcare strategies should focus on early detection and management of hypertension and cholesterol in older populations to prevent heart attacks.\n\nBy addressing these areas, public health policies can be tailored more effectively to mitigate heart attack risks across different age groups.\n\n## **6 Key References**\n\n-   [R for Visual Analytics](https://r4va.netlify.app/).\n\n-   [R for Data Science](https://r4ds.hadley.nz/).\n\n-   [Kaggle **Janan Heart attack database**](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult/data)\n",
    "supporting": [
      "Take-home_Ex1_version2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}