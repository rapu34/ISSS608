{
  "hash": "9b2db0b24642ae0dc3d3fc87a489559b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1\"\nauthor: \"Jeounghyun Kim\"\ndate: \"February 1, 2025\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n# **Take-home Exercise 1**\n\n## **1 Overview**\n\n### **1.1 Introduction**\n\nAccording to the World Health Organization (WHO), cardiovascular diseases (CVDs) are the leading cause of death globally, accounting for approximately 17.9 million deaths per year. Among CVDs, heart attacks are one of the most critical and life-threatening conditions, making early prevention and risk factor analysis essential.\n\nThis dataset provides an in-depth analysis of heart attack incidents in Japan, with a focus on the differences between youth and adult populations. It includes various medical indicators (cholesterol levels, blood pressure, maximum heart rate), lifestyle factors (exercise, diet), and demographic information, offering valuable insights into age-specific cardiovascular risks. By analyzing this dataset, researchers, healthcare professionals, and policymakers can gain a deeper understanding of these risks and develop more effective prevention strategies.\n\nThis dataset serves as a valuable resource for comparison with global cardiovascular research efforts, such as WHO's 'Global Hearts' initiative and the CDC's 'Million Hearts' program. Additionally, it supports statistical modeling, trend visualization, and predictive analytics, contributing to the development of data-driven public health policies and early intervention programs aimed at reducing the prevalence of cardiovascular diseases.\n\n## \n\n## **1.2 The Data**\n\nThe data for this analysis comes from the **Heart Attack in Japan: Youth vs. Adult** dataset, retrieved from the [Kaggle database](https://www.kaggle.com/datasets/ashaychoudhary/heart-attack-in-japan-youth-vs-adult/data). The dataset provides detailed information on heart attack incidents among youth and adults, focusing on medical indicators, lifestyle factors, and demographic characteristics.\n\n### **Dataset Components**\n\nThe dataset includes various features, such as:\n\n-   **Demographic Information:** Age, gender, and residential region (Urban/Rural).\n\n-   **Medical History:** Presence of pre-existing conditions such as **diabetes** and **hypertension**.\n\n-   **Lifestyle Factors:**\n\n    -   **Smoking History** and **Alcohol Consumption** levels.\n\n    -   **Physical Activity** categorized as High, Moderate, or Low.\n\n    -   **Diet Quality** classified as Good, Average, or Poor.\n\n-   **Medical Indicators:**\n\n    -   **Cholesterol Levels** (numerical values).\n\n    -   **Resting Blood Pressure** *(if available in the full dataset)*.\n\n-   **Additional Data Fields:** The dataset contains extra computed columns that may require further preprocessing for analysis.\n\nThis dataset serves as a valuable resource for data analysts, healthcare professionals, and policymakers aiming to understand and mitigate cardiovascular risks in Japan. Proper data preprocessing and ethical considerations are recommended before conducting any analysis.\n\nGetting started,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggiraph, plotly, \n               patchwork, DT, tidyverse,corrplot,reshape2,ggpairs)\n```\n:::\n\n\n\n## **1.2 Import**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_csv(\"japan_heart_attack_dataset.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 32\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Gender                  <chr> \"Male\", \"Male\", \"Male\", \"Female\", \"Female\", \"F…\n$ Region                  <chr> \"Urban\", \"Urban\", \"Rural\", \"Urban\", \"Rural\", \"…\n$ Smoking_History         <chr> \"Yes\", \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"Y…\n$ Diabetes_History        <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Hypertension_History    <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <chr> \"Moderate\", \"Low\", \"Low\", \"Moderate\", \"High\", …\n$ Diet_Quality            <chr> \"Poor\", \"Good\", \"Average\", \"Good\", \"Good\", \"Go…\n$ Alcohol_Consumption     <chr> \"Low\", \"Low\", \"Moderate\", \"High\", \"High\", \"Hig…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <chr> \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No…\n$ Heart_Attack_Occurrence <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\"…\n$ Extra_Column_1          <dbl> 0.40498852, 0.03627815, 0.85297888, 0.39085280…\n$ Extra_Column_2          <dbl> 0.43330004, 0.51256694, 0.21959083, 0.29684675…\n$ Extra_Column_3          <dbl> 0.62871236, 0.66839275, 0.61343656, 0.15572404…\n$ Extra_Column_4          <dbl> 0.70160955, 0.11552874, 0.50800995, 0.87025144…\n$ Extra_Column_5          <dbl> 0.49814235, 0.42381938, 0.90066981, 0.39035591…\n$ Extra_Column_6          <dbl> 0.007901312, 0.083932768, 0.227205241, 0.40318…\n$ Extra_Column_7          <dbl> 0.79458257, 0.68895108, 0.49634358, 0.74140891…\n$ Extra_Column_8          <dbl> 0.29077922, 0.83016364, 0.75210679, 0.22396813…\n$ Extra_Column_9          <dbl> 0.49719307, 0.63449028, 0.18150125, 0.32931387…\n$ Extra_Column_10         <dbl> 0.52199452, 0.30204337, 0.62918031, 0.14319054…\n$ Extra_Column_11         <dbl> 0.79965663, 0.04368285, 0.01827617, 0.90778075…\n$ Extra_Column_12         <dbl> 0.72239788, 0.45166789, 0.06322702, 0.54232201…\n$ Extra_Column_13         <dbl> 0.1487387, 0.8786714, 0.1465122, 0.9224606, 0.…\n$ Extra_Column_14         <dbl> 0.8340099, 0.5356022, 0.9972962, 0.6262165, 0.…\n$ Extra_Column_15         <dbl> 0.061632229, 0.617825340, 0.974455410, 0.22860…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Age           Gender             Region          Smoking_History   \n Min.   :18.00   Length:30000       Length:30000       Length:30000      \n 1st Qu.:33.00   Class :character   Class :character   Class :character  \n Median :48.00   Mode  :character   Mode  :character   Mode  :character  \n Mean   :48.49                                                           \n 3rd Qu.:64.00                                                           \n Max.   :79.00                                                           \n Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity \n Length:30000       Length:30000         Min.   : 80.02    Length:30000      \n Class :character   Class :character     1st Qu.:179.55    Class :character  \n Mode  :character   Mode  :character     Median :199.77    Mode  :character  \n                                         Mean   :199.90                      \n                                         3rd Qu.:220.16                      \n                                         Max.   :336.86                      \n Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       \n Length:30000       Length:30000        Min.   : 0.000   Min.   : 5.58  \n Class :character   Class :character    1st Qu.: 3.644   1st Qu.:21.63  \n Mode  :character   Mode  :character    Median : 4.993   Median :24.96  \n                                        Mean   : 5.002   Mean   :25.00  \n                                        3rd Qu.: 6.353   3rd Qu.:28.36  \n                                        Max.   :10.000   Max.   :46.10  \n   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    \n Min.   : 30.03   Min.   : 56.23   Min.   : 39.95   Length:30000      \n 1st Qu.: 63.25   1st Qu.:109.79   1st Qu.: 73.26   Class :character  \n Median : 69.95   Median :119.90   Median : 80.12   Mode  :character  \n Mean   : 69.98   Mean   :119.91   Mean   : 80.03                     \n 3rd Qu.: 76.66   3rd Qu.:130.02   3rd Qu.: 86.76                     \n Max.   :108.78   Max.   :178.77   Max.   :117.67                     \n Heart_Attack_Occurrence Extra_Column_1     Extra_Column_2     \n Length:30000            Min.   :0.000007   Min.   :0.0000052  \n Class :character        1st Qu.:0.253308   1st Qu.:0.2473606  \n Mode  :character        Median :0.500820   Median :0.4961980  \n                         Mean   :0.501939   Mean   :0.4978940  \n                         3rd Qu.:0.750529   3rd Qu.:0.7473954  \n                         Max.   :0.999965   Max.   :0.9999894  \n Extra_Column_3      Extra_Column_4      Extra_Column_5     Extra_Column_6     \n Min.   :0.0000227   Min.   :0.0000934   Min.   :0.000105   Min.   :0.0000531  \n 1st Qu.:0.2483093   1st Qu.:0.2522110   1st Qu.:0.251803   1st Qu.:0.2559989  \n Median :0.4976104   Median :0.4976175   Median :0.501987   Median :0.5017726  \n Mean   :0.4981949   Mean   :0.5005952   Mean   :0.501410   Mean   :0.5027631  \n 3rd Qu.:0.7476807   3rd Qu.:0.7505662   3rd Qu.:0.753657   3rd Qu.:0.7511886  \n Max.   :0.9999694   Max.   :0.9999869   Max.   :0.999995   Max.   :0.9998892  \n Extra_Column_7      Extra_Column_8      Extra_Column_9     \n Min.   :0.0000678   Min.   :0.0000449   Min.   :0.0000305  \n 1st Qu.:0.2482839   1st Qu.:0.2509790   1st Qu.:0.2502452  \n Median :0.4988157   Median :0.4985698   Median :0.4984491  \n Mean   :0.4980753   Mean   :0.5003557   Mean   :0.5002292  \n 3rd Qu.:0.7456378   3rd Qu.:0.7507293   3rd Qu.:0.7512186  \n Max.   :0.9999900   Max.   :0.9999300   Max.   :0.9999852  \n Extra_Column_10     Extra_Column_11     Extra_Column_12    \n Min.   :0.0000133   Min.   :0.0000008   Min.   :0.0000713  \n 1st Qu.:0.2484256   1st Qu.:0.2538092   1st Qu.:0.2505341  \n Median :0.5031040   Median :0.5067589   Median :0.5038609  \n Mean   :0.5010694   Mean   :0.5044949   Mean   :0.5008624  \n 3rd Qu.:0.7522686   3rd Qu.:0.7556257   3rd Qu.:0.7511780  \n Max.   :0.9999928   Max.   :0.9999578   Max.   :0.9999484  \n Extra_Column_13     Extra_Column_14     Extra_Column_15    \n Min.   :0.0000204   Min.   :0.0000025   Min.   :0.0000241  \n 1st Qu.:0.2473108   1st Qu.:0.2482152   1st Qu.:0.2482573  \n Median :0.5041162   Median :0.4943841   Median :0.5009406  \n Mean   :0.5004557   Mean   :0.4976507   Mean   :0.4999634  \n 3rd Qu.:0.7497094   3rd Qu.:0.7456212   3rd Qu.:0.7487379  \n Max.   :0.9999451   Max.   :0.9999779   Max.   :0.9999913  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  mutate(\n    # Yes/No 범주형 변수 → 0/1 변환\n    smoking_history = ifelse(Smoking_History == \"Yes\", 1, 0),\n    diabetes_history = ifelse(Diabetes_History == \"Yes\", 1, 0),\n    hypertension_history = ifelse(Hypertension_History == \"Yes\", 1, 0),\n    \n    # 성별 변환 (Male → 1, Female → 0)\n    gender = ifelse(Gender == \"Male\", 1, 0),\n\n    # 심장마비 여부 변환 (Yes → 1, No → 0)\n    heart_attack_occurrence = ifelse(Heart_Attack_Occurrence == \"Yes\", 1, 0)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(df)  # 컬럼명 출력\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Age\"                     \"Gender\"                 \n [3] \"Region\"                  \"Smoking_History\"        \n [5] \"Diabetes_History\"        \"Hypertension_History\"   \n [7] \"Cholesterol_Level\"       \"Physical_Activity\"      \n [9] \"Diet_Quality\"            \"Alcohol_Consumption\"    \n[11] \"Stress_Levels\"           \"BMI\"                    \n[13] \"Heart_Rate\"              \"Systolic_BP\"            \n[15] \"Diastolic_BP\"            \"Family_History\"         \n[17] \"Heart_Attack_Occurrence\" \"Extra_Column_1\"         \n[19] \"Extra_Column_2\"          \"Extra_Column_3\"         \n[21] \"Extra_Column_4\"          \"Extra_Column_5\"         \n[23] \"Extra_Column_6\"          \"Extra_Column_7\"         \n[25] \"Extra_Column_8\"          \"Extra_Column_9\"         \n[27] \"Extra_Column_10\"         \"Extra_Column_11\"        \n[29] \"Extra_Column_12\"         \"Extra_Column_13\"        \n[31] \"Extra_Column_14\"         \"Extra_Column_15\"        \n[33] \"smoking_history\"         \"diabetes_history\"       \n[35] \"hypertension_history\"    \"gender\"                 \n[37] \"heart_attack_occurrence\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  select(-starts_with(\"Extra_Column\"))\n```\n:::\n\n\n\n```         \n```\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>%\n  select(-Smoking_History, -Diabetes_History, -Hypertension_History, -Gender, -Heart_Attack_Occurrence)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot(cor_matrix, method = \"circle\", type = \"lower\",\n         col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(200),\n         tl.col = \"black\", tl.srt = 45, \n         addCoef.col = \"black\", \n         number.cex = 0.8, \n         title = \"Correlation Heatmap (corrplot)\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-10-1.png){width=1440}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Cholesterol_Level)) +\n  geom_histogram(fill = \"blue\", bins = 30, alpha = 0.7) +\n  labs(title = \"Cholesterol Level Distribution\", x = \"Cholesterol Level\", y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-11-1.png){width=1440}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = as.factor(heart_attack_occurrence), y = Cholesterol_Level, fill = as.factor(heart_attack_occurrence))) +\n  geom_boxplot() +\n  labs(title = \"Cholesterol Level by Heart Attack Occurrence\", x = \"Heart Attack (0 = No, 1 = Yes)\", y = \"Cholesterol Level\") +\n  scale_fill_manual(values = c(\"red\", \"blue\"))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = as.factor(smoking_history), fill = as.factor(heart_attack_occurrence))) +\n  geom_bar(position = \"fill\") +\n  labs(title = \"Heart Attack Occurrence by Smoking History\", x = \"Smoking History (0 = No, 1 = Yes)\", y = \"Proportion\") +\n  scale_fill_manual(values = c(\"red\", \"blue\"), name = \"Heart Attack\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Systolic_BP, y = Heart_Rate, color = as.factor(heart_attack_occurrence))) +\n  geom_point(alpha = 0.6) +\n  labs(title = \"Heart Rate vs. Systolic BP (by Heart Attack Occurrence)\", x = \"Systolic BP\", y = \"Heart Rate\") +\n  scale_color_manual(values = c(\"red\", \"blue\"), name = \"Heart Attack\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n여기서부터 다시 시작\n\n```{}\n```\n",
    "supporting": [
      "Take-home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}